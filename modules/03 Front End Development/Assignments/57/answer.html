<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Instush</title>

    <style>
        body {
            background-color: lightgray;
            height: 100%;
        }
        * {
            box-sizing: border-box;
        }
        #imagesPage {
            display: flex;
            flex-wrap: wrap;
            z-index: 0;
            pointer-events: auto;
        }
        .pictureObj {
            margin: 25px;
            z-index: 0;
        }
        .image {
            width: 200px;
            height: 200px;
            cursor: pointer;
            z-index: 0;
        }
        .image:hover {
            box-shadow: 10px 10px 8px 10px #888888;
        }
        .likeBtn {
            display: inline-block;
            margin-right: 130px;
            z-index: 0;
        }
        .picUtils {}
        .likeCounter {
            display: inline-block;
            z-index: 0;
        }
        #specialPicture {
            height: 400px;
            width: 400px;
            z-index: 2;
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-left: -200px;
            margin-top: -200px;
            cursor: pointer;
        }
        .blurMode {
            filter: blur(8px);
            -webkit-filter: blur(8px);
            z-index: 0;
        }
    </style>

</head>

<body>

    <img id="specialPicture" onclick="disableMainPic(event)">
    <div id="imagesPage">

        <div class="pictureObj" data-index="0">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="1">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="2">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="3">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="4">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="5">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="6">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="7">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="8">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="9">
            <img class="image"
                src="https://d4ougc3s3r7jj.cloudfront.net/images/design-assets/testimonials-dog-taller.png">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>

        <div class="pictureObj" data-index="10">
            <img class="image"
                src="https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
            <div class="picUtils">
                <button class="likeBtn">LIKE</button>
                <div class="likeCounter">0</div>
            </div>
        </div>
    </div>

    <script>
        var pics = document.querySelectorAll(".image");
        var picBtns = document.querySelectorAll(".likeBtn");
        function Picture() {
            this.src = "https://images.pexels.com/photos/556667/pexels-photo-556667.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500";
            this.amountOfLikes = 0;
            Picture.prototype.incrementLikes = function () {
                this.amountOfLikes += 1;
            }
        }
        for (var i = 0; i < pics.length; ++i) {
            pics[i].addEventListener("click", displayBlurringBackground, false);
        }
        function displayBlurringBackground(evt) {
            var thePage = document.querySelector("#imagesPage");
            if (!thePage.classList.contains("blurMode")) {
                thePage.classList.add("blurMode");
                thePage.style.pointerEvents = "none";
                displayMainPicture(evt.target);
            }
            else {
                alert("page already blurred OK?!");
            }
        }
        function displayMainPicture(imageToShow) {
            var mainPic = document.querySelector("#specialPicture");
            mainPic.src = imageToShow.src;
            mainPic.style.display = "block";
        }
        function disableMainPic(imgEvent) {
            var thePage = document.querySelector("#imagesPage");
            imgEvent.target.style.display = "none";
            thePage.style.pointerEvents = "auto";
            thePage.classList.toggle("blurMode")
        }
        function onStart()
        {
            var picsObj = {};
			
            if (localStorage.getItem("picObject")) {
				
				Object.assign(picsObj,JSON.parse(localStorage.getItem("picObject")));
				
				for(var i in picsObj)
				{
					picsObj[i].amountOfLikes = JSON.parse(localStorage.getItem("picObject"))[i].amountOfLikes;
				}
				
				for (var i = 0; i < picBtns.length; i++) {
                    picBtns[i].parentElement.lastElementChild.innerText = picsObj[i].amountOfLikes;
                }
            }
			

            else (Object.keys(picsObj).length === 0)
            {
                for (var i = 0; i < picBtns.length; ++i) {
                    var newPic = new Picture();
                    picsObj[i] = newPic;
                    
                    picBtns[i].onclick = function () {
                        var correspondIndex = this.parentElement.parentElement.getAttribute("data-index");
                        picsObj[correspondIndex].incrementLikes();
                        picBtns[correspondIndex].parentElement.lastElementChild.innerText = picsObj[correspondIndex].amountOfLikes;
                        localStorage.setItem("picObject", JSON.stringify(picsObj));
                    }
					
                }
            }
			
            for (var i = 0; i < picBtns.length; ++i) {
				picsObj[i].amountOfLikes = Number(picBtns[i].parentElement.lastElementChild.innerText);
			
                picBtns[i].onclick = function () {
					picBtns = document.querySelectorAll(".likeBtn");
                    var correspondIndex = this.parentElement.parentElement.getAttribute("data-index");
                    picsObj[correspondIndex].incrementLikes();
                    picBtns[correspondIndex].parentElement.lastElementChild.innerText = picsObj[correspondIndex].amountOfLikes;
                    localStorage.setItem("picObject", JSON.stringify(picsObj));
                }
            }
        }
        onStart();
    </script>
</body>

</html>
